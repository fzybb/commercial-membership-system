{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/fu_71/OneDrive/Desktop/fitness/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/fu_71/OneDrive/Desktop/fitness/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { getVideoDetail, saveOrder } from \"@/api/getData.js\";\nexport default {\n  data: function data() {\n    return {\n      videoinfo: {}\n    };\n  },\n  methods: {\n    //获取视频详情\n    getDetail: function getDetail(vid) {\n      var _this = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getVideoDetail(vid);\n            case 3:\n              result = _context.sent;\n              if (result.data.code == 0) {\n                _this.videoinfo = result.data.data;\n              }\n              _context.next = 10;\n              break;\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 7]]);\n      }))();\n    },\n    //下单\n    pay: function pay() {\n      var _this2 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var result, toast, _toast;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return saveOrder(_this2.$store.state.token, _this2.$route.query.video_id);\n            case 3:\n              result = _context2.sent;\n              if (result.data.code == 0) {\n                toast = _this2.$createToast({\n                  txt: \"购买成功\",\n                  type: \"correct\",\n                  time: 2000,\n                  onTimeout: function onTimeout() {\n                    _this2.$router.push({\n                      path: \"order\"\n                    });\n                  }\n                });\n                toast.show();\n              } else {\n                _toast = _this2.$createToast({\n                  txt: \"下单失败\",\n                  type: \"error\",\n                  time: 1500\n                });\n                _toast.show();\n              }\n              _context2.next = 10;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 7]]);\n      }))();\n    }\n  },\n  mounted: function mounted() {\n    this.getDetail(this.$route.query.video_id);\n  }\n};","map":{"version":3,"names":["getVideoDetail","saveOrder","data","videoinfo","methods","getDetail","vid","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","result","wrap","_callee$","_context","prev","next","sent","code","t0","console","log","stop","pay","_this2","_callee2","toast","_toast","_callee2$","_context2","$store","state","token","$route","query","video_id","$createToast","txt","type","time","onTimeout","$router","push","path","show","mounted"],"sources":["src/views/Pay/Pay.vue"],"sourcesContent":["<template>\n  <div>\n    <!--视频信息-->\n    <div class=\"info\">\n      <p class=\"info_title\">商品信息</p>\n      <div class=\"box\">\n        <div class=\"imgdiv\">\n          <img alt=\"课程照片\" :src=\"videoinfo.cover_img\" />\n        </div>\n        <div class=\"textdiv\">\n          <p class=\"c_title\">{{videoinfo.title}}</p>\n          <p class=\"price\">￥:&nbsp;&nbsp; {{(videoinfo.price / 100).toFixed(2)}}</p>\n        </div>\n      </div>\n    </div>\n    <!--顶部支付-->\n    <div class=\"footer\">\n      <p class=\"money\">实付:&nbsp;&nbsp; {{(videoinfo.price / 100).toFixed(2)}}</p>\n      <p class=\"submit\" @click=\"pay\">立刻支付</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getVideoDetail, saveOrder } from \"@/api/getData.js\";\n\nexport default {\n  data() {\n    return {\n      videoinfo: {}\n    };\n  },\n  methods: {\n    //获取视频详情\n    async getDetail(vid) {\n      try {\n        const result = await getVideoDetail(vid);\n        if (result.data.code == 0) {\n          this.videoinfo = result.data.data;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //下单\n    async pay() {\n      try {\n        const result = await saveOrder(\n          this.$store.state.token,\n          this.$route.query.video_id\n        );\n\n        if (result.data.code == 0) {\n          const toast = this.$createToast({\n            txt: \"购买成功\",\n            type: \"correct\",\n            time: 2000,\n            onTimeout: () => {\n              this.$router.push({ path: \"order\" });\n            }\n          });\n          toast.show();\n        }else{\n             const toast = this.$createToast({\n            txt: \"下单失败\",\n            type: \"error\",\n            time: 1500\n          });\n          toast.show();\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  },\n  mounted() {\n    this.getDetail(this.$route.query.video_id);\n  }\n};\n</script>\n\n\n<style lang=\"scss\" scoped>\n// 视频标题\n.info_title {\n  padding: 10px 20px;\n  background-color: #fff;\n  border-bottom: 1px solid #d9dde1;\n}\n\n.box {\n  background-color: #fff;\n  box-sizing: border-box;\n  padding: 20px;\n  display: flex;\n  margin-bottom: 15px;\n  .imgdiv {\n    width: 105px;\n    height: 59px;\n    flex-shrink: 0;\n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n  .textdiv {\n    margin-left: 20px;\n    height: 59px;\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    .price {\n      flex-shrink: 0;\n    }\n  }\n}\n//底部\n.footer {\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  height: 50px;\n  background-color: #fff;\n  display: flex;\n  justify-content: space-between;\n  box-shadow: 0 -2px 4px 0 rgba(0, 0, 0, 0.1);\n  font-size: 16px;\n  .money {\n    height: 50px;\n    line-height: 50px;\n    flex: 2;\n    text-align: center;\n    background-color: #fff;\n  }\n  .submit {\n    height: 50px;\n    line-height: 50px;\n    flex: 1;\n    text-align: center;\n    background-color: #ff2d50;\n    color: #fff;\n  }\n}\n</style>"],"mappings":";;;AAwBA,SAAAA,cAAA,EAAAC,SAAA;AAEA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA;IACA;EACA;EACAC,OAAA;IACA;IACAC,SAAA,WAAAA,UAAAC,GAAA;MAAA,IAAAC,KAAA;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,MAAA;QAAA,OAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAEAjB,cAAA,CAAAM,GAAA;YAAA;cAAAM,MAAA,GAAAG,QAAA,CAAAG,IAAA;cACA,IAAAN,MAAA,CAAAV,IAAA,CAAAiB,IAAA;gBACAZ,KAAA,CAAAJ,SAAA,GAAAS,MAAA,CAAAV,IAAA,CAAAA,IAAA;cACA;cAAAa,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAK,EAAA,GAAAL,QAAA;cAEAM,OAAA,CAAAC,GAAA,CAAAP,QAAA,CAAAK,EAAA;YAAA;YAAA;cAAA,OAAAL,QAAA,CAAAQ,IAAA;UAAA;QAAA,GAAAZ,OAAA;MAAA;IAEA;IAEA;IACAa,GAAA,WAAAA,IAAA;MAAA,IAAAC,MAAA;MAAA,OAAAjB,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAgB,SAAA;QAAA,IAAAd,MAAA,EAAAe,KAAA,EAAAC,MAAA;QAAA,OAAAnB,mBAAA,GAAAI,IAAA,UAAAgB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;YAAA;cAAAa,SAAA,CAAAd,IAAA;cAAAc,SAAA,CAAAb,IAAA;cAAA,OAEAhB,SAAA,CACAwB,MAAA,CAAAM,MAAA,CAAAC,KAAA,CAAAC,KAAA,EACAR,MAAA,CAAAS,MAAA,CAAAC,KAAA,CAAAC,QACA;YAAA;cAHAxB,MAAA,GAAAkB,SAAA,CAAAZ,IAAA;cAKA,IAAAN,MAAA,CAAAV,IAAA,CAAAiB,IAAA;gBACAQ,KAAA,GAAAF,MAAA,CAAAY,YAAA;kBACAC,GAAA;kBACAC,IAAA;kBACAC,IAAA;kBACAC,SAAA,WAAAA,UAAA;oBACAhB,MAAA,CAAAiB,OAAA,CAAAC,IAAA;sBAAAC,IAAA;oBAAA;kBACA;gBACA;gBACAjB,KAAA,CAAAkB,IAAA;cACA;gBACAlB,MAAA,GAAAF,MAAA,CAAAY,YAAA;kBACAC,GAAA;kBACAC,IAAA;kBACAC,IAAA;gBACA;gBACAb,MAAA,CAAAkB,IAAA;cACA;cAAAf,SAAA,CAAAb,IAAA;cAAA;YAAA;cAAAa,SAAA,CAAAd,IAAA;cAAAc,SAAA,CAAAV,EAAA,GAAAU,SAAA;cAEAT,OAAA,CAAAC,GAAA,CAAAQ,SAAA,CAAAV,EAAA;YAAA;YAAA;cAAA,OAAAU,SAAA,CAAAP,IAAA;UAAA;QAAA,GAAAG,QAAA;MAAA;IAEA;EACA;EACAoB,OAAA,WAAAA,QAAA;IACA,KAAAzC,SAAA,MAAA6B,MAAA,CAAAC,KAAA,CAAAC,QAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}