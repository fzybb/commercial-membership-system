{"ast":null,"code":"import \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport CubeRateItem from './rate-item.vue';\nvar COMPONENT_NAME = 'cube-rate';\nvar EVENT_INPUT = 'input';\nvar EVENT_TYPE_MOUSE = 'mouse';\nexport default {\n  name: COMPONENT_NAME,\n  props: {\n    value: {\n      type: Number,\n      \"default\": 0\n    },\n    max: {\n      type: Number,\n      \"default\": 5\n    },\n    disabled: {\n      type: Boolean,\n      \"default\": false\n    },\n    justify: {\n      type: Boolean,\n      \"default\": false\n    }\n  },\n  data: function data() {\n    return {\n      tempValue: this.value\n    };\n  },\n  created: function created() {\n    this.mousePressed = false;\n  },\n  computed: {\n    rateClass: function rateClass() {\n      return this.justify && 'cube-rate-justify';\n    }\n  },\n  watch: {\n    value: function value(val) {\n      if (val !== this.tempValue) {\n        this.tempValue = val;\n      }\n    }\n  },\n  methods: {\n    handleStart: function handleStart(e) {\n      if (!this.disabled) {\n        if (e.type.indexOf(EVENT_TYPE_MOUSE) > -1) {\n          this.mousePressed = true;\n          document.addEventListener('mouseup', this.handleEnd);\n          document.addEventListener('mousemove', this.handleMove);\n        }\n        var rect = this.$refs.rateContainer.getBoundingClientRect();\n        this.left = rect.left;\n        this.containerWidth = rect.width;\n      }\n    },\n    handleMove: function handleMove(e) {\n      if (!this.disabled && (e.type.indexOf(EVENT_TYPE_MOUSE) === -1 || this.mousePressed)) {\n        this.computeTempValue(e.type.indexOf(EVENT_TYPE_MOUSE) === -1 ? e.touches[0] : e);\n      }\n    },\n    handleEnd: function handleEnd(e) {\n      if (!this.disabled && (e.type.indexOf(EVENT_TYPE_MOUSE) === -1 || this.mousePressed)) {\n        if (e.type.indexOf(EVENT_TYPE_MOUSE) > -1) {\n          this.mousePressed = false;\n          document.removeEventListener('mouseup', this.handleEnd);\n          document.removeEventListener('mousemove', this.handleMove);\n        }\n        this.computeTempValue(e.type.indexOf(EVENT_TYPE_MOUSE) > -1 ? e : e.changedTouches[0]);\n        this.$emit(EVENT_INPUT, this.tempValue);\n      }\n    },\n    computeTempValue: function computeTempValue(touch) {\n      var leftAmount = Math.ceil((touch.clientX - this.left) / this.containerWidth * this.max);\n      if (leftAmount > 0 && leftAmount <= this.max) {\n        this.tempValue = leftAmount;\n      } else if (leftAmount <= 0) {\n        this.tempValue = 0;\n      } else {\n        this.tempValue = this.max;\n      }\n    }\n  },\n  components: {\n    CubeRateItem: CubeRateItem\n  }\n};","map":{"version":3,"names":["CubeRateItem","COMPONENT_NAME","EVENT_INPUT","EVENT_TYPE_MOUSE","name","props","value","type","Number","max","disabled","Boolean","justify","data","tempValue","created","mousePressed","computed","rateClass","watch","val","methods","handleStart","e","indexOf","document","addEventListener","handleEnd","handleMove","rect","$refs","rateContainer","getBoundingClientRect","left","containerWidth","width","computeTempValue","touches","removeEventListener","changedTouches","$emit","touch","leftAmount","Math","ceil","clientX","components"],"sources":["node_modules/cube-ui/src/components/rate/rate.vue"],"sourcesContent":["<template>\n  <!-- the preventDefault of touchmove is to prevent any default action caused by any touchmove event associated with the same active touch point, such as scrolling. -->\n  <ul ref=\"rateContainer\"\n      class=\"cube-rate\"\n      :class=\"rateClass\"\n      @touchstart.stop=\"handleStart\"\n      @touchmove.stop.prevent=\"handleMove\"\n      @touchend.stop=\"handleEnd\"\n      @mousedown.stop=\"handleStart\"\n      @mousemove.stop=\"handleMove\"\n      @mouseup.stop=\"handleEnd\">\n      <slot>\n        <cube-rate-item v-for=\"n in max\" :key=\"n\" :index=\"n\"></cube-rate-item>\n      </slot>\n    </ul>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  import CubeRateItem from './rate-item.vue'\n  const COMPONENT_NAME = 'cube-rate'\n  const EVENT_INPUT = 'input'\n\n  const EVENT_TYPE_MOUSE = 'mouse'\n\n  export default {\n    name: COMPONENT_NAME,\n    props: {\n      value: {\n        type: Number,\n        default: 0\n      },\n      max: {\n        type: Number,\n        default: 5\n      },\n      disabled: {\n        type: Boolean,\n        default: false\n      },\n      justify: {\n        type: Boolean,\n        default: false\n      }\n    },\n    data() {\n      return {\n        tempValue: this.value\n      }\n    },\n    created() {\n      this.mousePressed = false\n    },\n    computed: {\n      rateClass() {\n        return this.justify && 'cube-rate-justify'\n      }\n    },\n    watch: {\n      value(val) {\n        if (val !== this.tempValue) {\n          this.tempValue = val\n        }\n      }\n    },\n    methods: {\n      handleStart(e) {\n        if (!this.disabled) {\n          if (e.type.indexOf(EVENT_TYPE_MOUSE) > -1) {\n            this.mousePressed = true\n            document.addEventListener('mouseup', this.handleEnd)\n            document.addEventListener('mousemove', this.handleMove)\n          }\n          const rect = this.$refs.rateContainer.getBoundingClientRect()\n          this.left = rect.left\n          this.containerWidth = rect.width\n        }\n      },\n      handleMove(e) {\n        if (!this.disabled && (e.type.indexOf(EVENT_TYPE_MOUSE) === -1 || this.mousePressed)) {\n          this.computeTempValue(e.type.indexOf(EVENT_TYPE_MOUSE) === -1 ? e.touches[0] : e)\n        }\n      },\n      handleEnd(e) {\n        if (!this.disabled && (e.type.indexOf(EVENT_TYPE_MOUSE) === -1 || this.mousePressed)) {\n          if (e.type.indexOf(EVENT_TYPE_MOUSE) > -1) {\n            this.mousePressed = false\n            document.removeEventListener('mouseup', this.handleEnd)\n            document.removeEventListener('mousemove', this.handleMove)\n          }\n          this.computeTempValue(e.type.indexOf(EVENT_TYPE_MOUSE) > -1 ? e : e.changedTouches[0])\n          this.$emit(EVENT_INPUT, this.tempValue)\n        }\n      },\n      computeTempValue(touch) {\n        let leftAmount = Math.ceil((touch.clientX - this.left) / this.containerWidth * this.max)\n        if (leftAmount > 0 && leftAmount <= this.max) {\n          this.tempValue = leftAmount\n        } else if (leftAmount <= 0) {\n          this.tempValue = 0\n        } else {\n          this.tempValue = this.max\n        }\n      }\n    },\n    components: {\n      CubeRateItem\n    }\n  }\n</script>\n\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n\n  .cube-rate\n    list-style: none\n    display: inline-flex\n    vertical-align: top\n    flex-wrap: nowrap\n    max-width: 100%\n  .cube-rate-justify\n    width: 100%\n    justify-content: space-between\n</style>\n"],"mappings":";;AAkBA,OAAAA,YAAA;AACA,IAAAC,cAAA;AACA,IAAAC,WAAA;AAEA,IAAAC,gBAAA;AAEA;EACAC,IAAA,EAAAH,cAAA;EACAI,KAAA;IACAC,KAAA;MACAC,IAAA,EAAAC,MAAA;MACA;IACA;IACAC,GAAA;MACAF,IAAA,EAAAC,MAAA;MACA;IACA;IACAE,QAAA;MACAH,IAAA,EAAAI,OAAA;MACA;IACA;IACAC,OAAA;MACAL,IAAA,EAAAI,OAAA;MACA;IACA;EACA;EACAE,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA,OAAAR;IACA;EACA;EACAS,OAAA,WAAAA,QAAA;IACA,KAAAC,YAAA;EACA;EACAC,QAAA;IACAC,SAAA,WAAAA,UAAA;MACA,YAAAN,OAAA;IACA;EACA;EACAO,KAAA;IACAb,KAAA,WAAAA,MAAAc,GAAA;MACA,IAAAA,GAAA,UAAAN,SAAA;QACA,KAAAA,SAAA,GAAAM,GAAA;MACA;IACA;EACA;EACAC,OAAA;IACAC,WAAA,WAAAA,YAAAC,CAAA;MACA,UAAAb,QAAA;QACA,IAAAa,CAAA,CAAAhB,IAAA,CAAAiB,OAAA,CAAArB,gBAAA;UACA,KAAAa,YAAA;UACAS,QAAA,CAAAC,gBAAA,iBAAAC,SAAA;UACAF,QAAA,CAAAC,gBAAA,mBAAAE,UAAA;QACA;QACA,IAAAC,IAAA,QAAAC,KAAA,CAAAC,aAAA,CAAAC,qBAAA;QACA,KAAAC,IAAA,GAAAJ,IAAA,CAAAI,IAAA;QACA,KAAAC,cAAA,GAAAL,IAAA,CAAAM,KAAA;MACA;IACA;IACAP,UAAA,WAAAA,WAAAL,CAAA;MACA,UAAAb,QAAA,KAAAa,CAAA,CAAAhB,IAAA,CAAAiB,OAAA,CAAArB,gBAAA,iBAAAa,YAAA;QACA,KAAAoB,gBAAA,CAAAb,CAAA,CAAAhB,IAAA,CAAAiB,OAAA,CAAArB,gBAAA,WAAAoB,CAAA,CAAAc,OAAA,MAAAd,CAAA;MACA;IACA;IACAI,SAAA,WAAAA,UAAAJ,CAAA;MACA,UAAAb,QAAA,KAAAa,CAAA,CAAAhB,IAAA,CAAAiB,OAAA,CAAArB,gBAAA,iBAAAa,YAAA;QACA,IAAAO,CAAA,CAAAhB,IAAA,CAAAiB,OAAA,CAAArB,gBAAA;UACA,KAAAa,YAAA;UACAS,QAAA,CAAAa,mBAAA,iBAAAX,SAAA;UACAF,QAAA,CAAAa,mBAAA,mBAAAV,UAAA;QACA;QACA,KAAAQ,gBAAA,CAAAb,CAAA,CAAAhB,IAAA,CAAAiB,OAAA,CAAArB,gBAAA,SAAAoB,CAAA,GAAAA,CAAA,CAAAgB,cAAA;QACA,KAAAC,KAAA,CAAAtC,WAAA,OAAAY,SAAA;MACA;IACA;IACAsB,gBAAA,WAAAA,iBAAAK,KAAA;MACA,IAAAC,UAAA,GAAAC,IAAA,CAAAC,IAAA,EAAAH,KAAA,CAAAI,OAAA,QAAAZ,IAAA,SAAAC,cAAA,QAAAzB,GAAA;MACA,IAAAiC,UAAA,QAAAA,UAAA,SAAAjC,GAAA;QACA,KAAAK,SAAA,GAAA4B,UAAA;MACA,WAAAA,UAAA;QACA,KAAA5B,SAAA;MACA;QACA,KAAAA,SAAA,QAAAL,GAAA;MACA;IACA;EACA;EACAqC,UAAA;IACA9C,YAAA,EAAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}